#####
# Automation to daily send to Telegram inforamtion about total energy usage.
#####

alias: "Daily Energy Use Message"
id: 4da1cc10-db2b-48dc-baf9-2e6fcd423731

trigger:
  platform: time
  at: "23:59:50"

action:
  - service: script.notify_engine
    data:
      who: "simeon"
      title: "â˜€ï¸âš¡ï¸ğŸ”¥ Energy Usage "
      value1: "Today's energy use was:
        âš¡ï¸ Grid imported: {{ states('sensor.grid_imported_power_daily') }} kWh  (API Â£ {{ states('sensor.electric_cost_today') }})
        â˜€ï¸ Solar exported: {{ states('sensor.solar_exported_power_daily') }} kWh (Â£{{ states('sensor.solar_exported_power_daily_compensation') }})
        â˜€ï¸ Solar production: {{ states('sensor.solar_production_daily') }} kWh
        ğŸ”¥ Gas: API Â£{{ states('sensor.gas_cost_today') }}"
      target_id: !secret telegram_bot_chat_id
      group: home
      tag_id: "information"
      importance_id: default
      color: "green"
      sticky: "false"
      timeout: 300
